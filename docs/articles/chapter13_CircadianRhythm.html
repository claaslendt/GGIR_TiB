<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>13. Circadian Rhythm Analysis • GGIR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="13. Circadian Rhythm Analysis">
<script defer data-domain="pkgdown.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GGIR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.1-2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-the-book" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">The book</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-the-book">
<li><a class="dropdown-item" href="../articles/chapter1_WhatIsGGIR.html">1. What is GGIR</a></li>
    <li><a class="dropdown-item" href="../articles/chapter2_Pipeline.html">2. The GGIR Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/chapter3_QualityAssessment.html">3. Data Quality Assurance</a></li>
    <li><a class="dropdown-item" href="../articles/chapter4_AccMetrics.html">4. From Raw Data to Acceleration Metrics</a></li>
    <li><a class="dropdown-item" href="../articles/chapter5_StudyProtocol.html">5. Accounting for Study Protocol</a></li>
    <li><a class="dropdown-item" href="../articles/chapter6_DataImputation.html">6. How GGIR Deals with Invalid Data</a></li>
    <li><a class="dropdown-item" href="../articles/chapter7_DescribingDataWithoutKnowingSleep.html">7. Describing the Data Without Knowing Sleep</a></li>
    <li><a class="dropdown-item" href="../articles/chapter8_SleepFundamentalsSibs.html">8. Sleep Fundamentals - Sustained Inactivity Bout Detection (SIB)</a></li>
    <li><a class="dropdown-item" href="../articles/chapter9_SleepFundamentalsGuiders.html">9. Sleep Fundamentals - Guiding Sleep Detection</a></li>
    <li><a class="dropdown-item" href="../articles/chapter10_SleepAnalysis.html">10. Sleep Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/chapter11_DescribingDataCutPoints.html">11. Physical Activity Fundamentals - Describing the data with cut-points</a></li>
    <li><a class="dropdown-item" href="../articles/chapter12_TimeUseAnalysis.html">12. Time-Use Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/chapter13_CircadianRhythm.html">13. Circadian Rhythm Analysis</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-annexes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Annexes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-annexes">
<li><a class="dropdown-item" href="../articles/GGIRParameters.html">GGIR Parameters</a></li>
    <li><a class="dropdown-item" href="../articles/GGIRoutput.html">GGIR Output</a></li>
    <li><a class="dropdown-item" href="../articles/readmyacccsv.html">Reading csv files with raw data</a></li>
    <li><a class="dropdown-item" href="../articles/ExternalFunction.html">Embedding external functions in GGIR</a></li>
    <li><a class="dropdown-item" href="../articles/CutPoints.html">Published cut-points and how to use them</a></li>
    <li><a class="dropdown-item" href="../articles/TutorialDaySegmentAnalyses.html">Day-segment analyses</a></li>
    <li><a class="dropdown-item" href="../articles/HouseHoldCoanalysis.html">Household co-analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Cookbook.html">Cookbook</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/chapter0_Installation.html">Installation</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/chapter0_GetStarted.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.accelting.com/updates/ggir-release-3-1-0/">Version 3.1-0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.accelting.com/updates/ggir-release-3-0-0/">Version 3.0-0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.accelting.com/updates/ggir-release-2-9-0/">Version 2.9-0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.accelting.com/updates/ggir-release-2-8-0/">Version 2.8-0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.accelting.com/updates/ggir-release-2-7-1/">Version 2.7-1</a></li>
    <li><a class="external-link dropdown-item" href="https://www.accelting.com/updates/ggir-release-2-6-0/">Version 2.6-0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.accelting.com/updates/ggir-release-2-5-0/">Version 2.5-0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/chapter0_Contributing.html">Contributing</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/chapter0_Support.html">Need help?</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/wadpac/GGIR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/RpackageGGIR" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>13. Circadian Rhythm Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/wadpac/GGIR/blob/HEAD/vignettes/chapter13_CircadianRhythm.Rmd" class="external-link"><code>vignettes/chapter13_CircadianRhythm.Rmd</code></a></small>
      <div class="d-none name"><code>chapter13_CircadianRhythm.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="mxlx">MXLX<a class="anchor" aria-label="anchor" href="#mxlx"></a>
</h2>
<p>Detection of the continuous least (LX) and most (MX) active X hours
in a day, where X is defined by argument <code>winhr</code>. For both
GGIR calculates the average acceleration, the start time, and if
argument <code>iglevels</code> is specified also the intensity gradient.
If argument <code>winhr</code> is a vector then descriptive values for
LX and MX are derived per value in <code>winhr</code>.</p>
<p>Within GGIR part 2 MXLX is calculated per calendar day and, if
argument <code>qwindow</code> is specified, per segment of the day.
Within GGIR part 5 MXLX is calculated per window, and if used in
combination with the GENEActiv or Axivity accelerometer brand LUX
estimates per LX and MX are included.</p>
<p>The MX metric described here should not be confused by the MX metrics
as proposed by <a href="https://doi.org/10.1186/s40798-019-0225-9" class="external-link">Rowlands et al.</a>
which looks at accumulated most active time which may not always be
continuous in time. The MX metrics by Rowlands et al. are discussed <a href="https://wadpac.github.io/GGIR/articles/chapter7_DescribingDataWithoutKnowingSleep.html#sets-of-quantiles-mx-metrics-by-rowlands-et-al-">here</a>.</p>
</div>
<div class="section level2">
<h2 id="cosinor-analysis-and-extended-cosinor-analysis">Cosinor analysis and Extended Cosinor analysis<a class="anchor" aria-label="anchor" href="#cosinor-analysis-and-extended-cosinor-analysis"></a>
</h2>
<p><strong>Disclaimer: This functionality is currently (2024) being
revised. Once the enhancements have been incorporated in a GGIR release
this section will also be updated.</strong></p>
<p>The (Extended) Cosinor analysis quantifies the circadian 24 hour
cycle. Cosinor analysis refers to fiting a cosine function to a time
series, while the extended cosinor analysis refers to fitting a cosine
function to the transformed time series afrer Marler et al. Statist.
Med. 2006 (doi: 10.1002/sim.2466).</p>
<p>To do this GGIR uses R package <a href="https://CRAN.R-project.org/package=ActCR" class="external-link">ActCR</a> as a
dependency. Specify argument <code>cosinor = TRUE</code> to perform
these analysis.</p>
<p>GGIR performs cosinor analysis both in part 2 and 6.</p>
<p>The implementation within GGIR part 2 is as follows:</p>
<ul>
<li>Acceleration values are averaged per minute, and then log
transformation as
<code>log(acceleration converted to _mg_ + 1)</code>.</li>
<li>Invalid data points such as caused by non-wear are set to missing
(<code>NA</code>) in order to prevent the imputation approach used
elsewhere in GGIR to influence the Cosinor analysis. We do this because
imputation technique generally come with some assumptions about
circadian rhythm.</li>
<li>GGIR looks for the first valid data point in the recording and then
selects the maximum integer number of recording days following this data
point and feeds these to the ActCosinor and ActExtendCosinor functions
of ActCR. The time offset between the start and the following midnight
is then used to reverse offset the ActCR results, to ensure that
acrophase and acrotime can be interpreted relative to midnight.</li>
<li>In relation to Day Saving Time: Duplicated time stamps when clock
moves backward are ignored and missing time stamps when clock moves
forward are inserted as missing values.</li>
<li>Time series corresponding to the fitted models are stored inside the
part 2 milestone data to facilitate visual inspection. For the moment
they are not used in any GGIR visualisation, but you may want to look
them up and try to plot them yourself.</li>
</ul>
<p>The implementation within GGIR part 6 is as follows: - Only the time
series are used in the interval as defined with parameter
<code>part6Window</code>. - Make sure to set
<code>save_ms5raw_without_invalid = FALSE</code>, after the revision it
will also handle setting this to TRUE but for the moment TRUE introduces
errors.</p>
</div>
<div class="section level2">
<h2 id="intradaily-variability-iv-and-interdaily-stability-is">Intradaily Variability (IV) and Interdaily Stability (IS)<a class="anchor" aria-label="anchor" href="#intradaily-variability-iv-and-interdaily-stability-is"></a>
</h2>
<p><strong>Disclaimer: This functionality is currently (2024) being
revised. Once the enhancements have been incorporated in a GGIR release
this section will also be updated.</strong></p>
<div class="section level3">
<h3 id="iv-and-is---default">IV and IS - Default<a class="anchor" aria-label="anchor" href="#iv-and-is---default"></a>
</h3>
<p>The original implementation (argument
<code>IVIS.activity.metric = 1</code>) uses the continuous numeric
acceleration values. However, as we later realised, this is not
compatible with the original approach by van Someren and colleagues,
which uses a binary distinction between active and inactive. Therefore,
a second option was added (argument
<code>IVIS.activity.metric = 2</code>), which needs to be used in
combination with accelerometer metric ENMO, and collapses the
acceleration values into a binary score of rest versus active. This is
the current default.</p>
</div>
<div class="section level3">
<h3 id="iv-and-is---cosinor-analysis-compatible">IV and IS - Cosinor analysis compatible<a class="anchor" aria-label="anchor" href="#iv-and-is---cosinor-analysis-compatible"></a>
</h3>
<p>IS is sometimes used as a measure of behavioural robustness when
conducting Cosinor analysis. However, to work with the combination of
the two outcomes it seems important that IS is calculated from the same
time series. Therefore, when <code>cosinor = TRUE</code> IV and IS are
calculated twice: Once as part of the default IV and IS analysis as
discussed above, and once as part of the Cosinor analysis using the same
log transformed time series. More specifically, the IV and IS algorithm
is applied with <code>IVIS.activity.metric = 2</code> and a threshold
<code>IVIS_acc_threshold = log(20 + 1)</code> to make the binary
distinction between active and inactive, and
<code>IVIS_per_daypair = TRUE</code>. The setting
<code>IVIS_per_daypair</code> was specifically designed for this context
to handle the potentially missing values in the time series as used for
Cosinor analysis. Applying the default IVIS algorithm would not be able
to handle the missing values and would result in a loss of information
if all non-matching epochs across the entire recording were excluded.
Instead, IV and IS are calculated as follows:</p>
<ol style="list-style-type: decimal">
<li>Per day pair based on matching valid epochs only IV and IS and
calculated. Here, a log is kept of the number of valid epochs per day
pair.</li>
<li>Omit day pairs where the fraction of valid epoch pairs is below 0.66
(0.66 is hard-coded at the moment).</li>
<li>Calculate average IS across days weighted by fraction of valid
epochs per day pairs.</li>
</ol>
<p>The new Cosinor-compatible IV and IS estimates are stored as output
variables <code>cosinorIV</code> and <code>cosinorIS</code>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vincent T van Hees, Jairo H Migueles, Medical Research Council UK, Accelting, French National Research Agency.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
